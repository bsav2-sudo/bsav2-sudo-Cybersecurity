# Security_Footage_THM

![5e9c5d0148cf664325c8a075-1746621142415](https://github.com/user-attachments/assets/b340cc95-c453-447b-8cb2-4c8c2c46c962)

## Overview

This is my writeup of the process of completing the TryHackMe CTF - Security Footage. The scenario is as follows:

"Someone broke into our office last night, but they destroyed the hard drives with the security footage. Can you recover the footage?"

This write-up follows the prcoess I went through to go through the PCAP file and piece the evidence together to collect the flag!

## Process

So where to start on a CTF challange - well I need to get my playlist on to be able to focus thats a start - but then its straight at looking at the information and resources I've been given for the challange. Which in this case was just one PCAP file. Cool, not a lot but this PCAP should have all the answers then. So first things first lets get this PCAP open up in the Wireshark GUI and see what we are working with (please note all screenshots were taken after comnpleting the challange - time on screenshots is not true):

![Wireshark](https://github.com/user-attachments/assets/5edd7bfc-8b15-4541-906b-aedfbd0d4177)

Okie dokie, first things first - we have a TCP conversation taking place throughout the capture between two IP addresses - 10.0.2.15 and 192.168.1.100. Now I can see the protocol is TCP for all of this conversation which means I'm going to have to folllow this TCP stream for the full conversation and see what info is available - if it was a RTP stream I may have been able to decode it but in this case it is not.

So all I'm going to do is right click on one of the packets > Follow > TCP Stream.

![TCP Stream](https://github.com/user-attachments/assets/63bd6fe9-91ee-4d43-bfcb-950dda1b0c23)

And this is what the TCP Stream looks like - we have two HTTP messages at the start then a boundary string which then starts the video stream. Cool okay this is something I can look at. Straight away on the boundary string one of the first things that is catching my eye is the Content-Type header which is JPEG. So we know we are working with the JPEG format.

![JPEG header](https://github.com/user-attachments/assets/252f6f76-c39f-45e3-86a6-a009554a963f)

I think the best strategy for this is going to be using the tool Foremost - it's a tool I've very rarely used but one I know can recover lost or deleted footage by using footers, headers and internal data structures.

> Foremost is a forensic program to recover lost files based on their headers, footers, and internal data structures.
>
> Foremost can work on image files, such as those generated by dd, Safeback, Encase, etc, or directly on a drive. The headers and footers can be specified by a configuration file or you can use command line switches to specify built-in file types. These built-in types look at the data structures of a given file format allowing for a more reliable and faster recovery.

Yep definetly looks like the best option so what am I going to need from this, well three things:

- The tool itself
- Binary file from the PCAP to feed into the tool
- What format is being used

Well one of those is already answered - we're going to be looking for the JPEG format.

Okay time to grab the tool itself and the binary file - to get the file I'm just going to go to Kali Linux Tools and look at the instructions to get it installed on my Ubuntu machine - [Kali Tools - Foremost](https://www.kali.org/tools/foremost/) - link for anyone who needs it - just a standard install :)

Now for the binary data - in Wireshark on this TCP stream - all I am going to do is change the Show data as field from ASCII to RAW.

![Convert to RAW ](https://github.com/user-attachments/assets/163fea02-ebed-4ddf-a171-7cad52619ff9)

Theres the stream in a RAW format - looks great - now lets get it saved to a file to be able to feed into foremost - doing this is as simple as clicking on Save As in Wireshark and then naming the file as a .bin (for binary data).

![BInary File Save](https://github.com/user-attachments/assets/28744bd3-5192-475e-bd96-596cd5518f32)

Great - lets just check this binary file to make sure it looks how we expect it to look:

![RAW Data Open](https://github.com/user-attachments/assets/7593cc3a-8fcd-4781-b037-201b02eb73bc)

Yep looks like some binary data to me - time to shut Wireshark and get Foremost open through the terminal. Now this is my first time actually using the tool so I'm going to use the -h argument to bring up the help options:

![Foremost Help](https://github.com/user-attachments/assets/fbda8d43-1c75-4db8-9b78-01a2fb6e625b)

Okay so I know I need to use the following three arguments:

- -t - to specify the file type
- -i - to specify the input file
- -o - set an output directory

Okay so lets put in the information and have a look at the final command:

![Foremost](https://github.com/user-attachments/assets/c3b1a05e-2b5d-4392-b341-644150594fb9)

And let it run! A few seconds later we get the results - so off I go to navigate to the directory we told foremost to save all the info to. We get one folder named 'JPEG' and also an audit.txt - lets take a look at the audit first - and we can see foremost got a lot of photos (5MB worth to be exact).

![Audit of Images](https://github.com/user-attachments/assets/9ed4d596-eabb-4a64-8ebe-78980b6855e4)

And now checking the folder - there's all the photo's!

![All Photos](https://github.com/user-attachments/assets/6f5e5eff-15bd-491a-8097-ea9c7f83a0d1)

Now I know at this point I could just make a python script to put all the images together and form a video - however the easiest way for me to get the flag is to just open the photo in the default photo editor and press the right button to quickly scroll through the photos and build a small video - and there we are the flag is there (obviously not going to post in here what the flag is).

<img width="1439" alt="Screenshot 2025-05-15 194803" src="https://github.com/user-attachments/assets/85a70383-02d1-454b-aede-69d5d5e1d932" />

## Conclusion

This was quite a fun one to do - it took me a while to figure out foremost would be one of the tools I'd need to use but being able to navigate the PCAP was simple enough thanks to other PCAP analysis I've done in this portfolio and on other projects.

Thanks for reading :)
